<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yu Ji" />

<meta name="date" content="2021-12-20" />

<title>All Homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">All Homework</h1>
<h4 class="author">Yu Ji</h4>
<h4 class="date">2021-12-20</h4>



<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>Go through “R for Beginners” if you are not familiar with R programming.</p>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables).</p>
</div>
<div id="answer2" class="section level2">
<h2>Answer2</h2>
<p>Reference in this answer is the following web <a href="https://yihui.org/knitr/options/" class="uri">https://yihui.org/knitr/options/</a>.</p>
<p>(a)texts: reference in this part is Text output from the above web.</p>
<p>(b)figures:reference in this part is Plots from the above web.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span>)         <span class="co"># high-level plot</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)    <span class="co"># low-level change</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>)) <span class="co"># high-level plot</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># many low-level changes in a loop (a single R expression)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> i, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(c)tables: Here we use knitr::kable.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">sep=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="at">name=</span>LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>],<span class="at">month=</span>month.abb[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(res)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">sep</th>
<th align="left">name</th>
<th align="left">month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="left">Jan</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B</td>
<td align="left">Feb</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="left">Mar</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">D</td>
<td align="left">Apr</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">E</td>
<td align="left">May</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">F</td>
<td align="left">Jun</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">G</td>
<td align="left">Jul</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">H</td>
<td align="left">Aug</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">I</td>
<td align="left">Sep</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">J</td>
<td align="left">Oct</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">K</td>
<td align="left">Nov</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">L</td>
<td align="left">Dec</td>
</tr>
</tbody>
</table>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>Two years ago, the COVID-19 outbroke over the world. During the period at home, I learned a little about R and Rmarkdown. However, I never knew the package knitr. Now I find knitr is so convenient and useful.</p>
<p>To know more about this package and R statistic analysis, I recommend two webs and an official accounts:</p>
<p>Web1:<a href="https://cosx.org/2012/06/reproducible-research-with-knitr/" class="uri">https://cosx.org/2012/06/reproducible-research-with-knitr/</a></p>
<p>Web2:<a href="https://yihui.org/knitr/options/" class="uri">https://yihui.org/knitr/options/</a>.</p>
<p>Official accounts:Capital of Statistics.</p>
<p>Here I give another two interesting blog about Yihui Xie:<a href="https://cosx.org/2016/01/interview-of-xieyihui" class="uri">https://cosx.org/2016/01/interview-of-xieyihui</a> and <a href="https://yihui.org/" class="uri">https://yihui.org/</a>.</p>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="qusetion1" class="section level2">
<h2>Qusetion1</h2>
<p>Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\quad x\ge0,a&gt;0.\]</span> Develop an algorithm to generate random samples from a Rayleigh distribution. Generate Rayleigh samples for several choices of <span class="math inline">\(\sigma&gt;0\)</span> and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>(check the histogram).</p>
</div>
<div id="answer1" class="section level2">
<h2>Answer1</h2>
<p>From the pdf, we can easy get the cdf <span class="math display">\[F(x)=1-e^{-x^2/(2\sigma^2)},\quad x\ge0,a&gt;0.\]</span>. Consider the Inverse Transform Method, we have <span class="math inline">\(F_X^{-1}(u)=\sqrt{-2\sigma^2\log(1-u)}\)</span>.</p>
<p>The process is as follows:</p>
<p>(a)Generate a random u from Uniform(0,1).</p>
<p>(b)Deliver <span class="math inline">\(x=F_X^{-1}(u)\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#sigma=1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="st">&quot;sigma=1&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.001</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">1</span><span class="sc">*</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">*</span><span class="dv">1</span>))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#sigma=10</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="st">&quot;sigma=10&quot;</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="fl">0.001</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">*</span><span class="dv">10</span>))<span class="sc">/</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">10</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question2-1" class="section level2">
<h2>Question2</h2>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0, 1) and N(3, 1) distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2=1-p_1\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_1=0.75\)</span>. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_1\)</span> that produce bimodal mixtures.</p>
</div>
<div id="answer2-1" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#p=0.75</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fl">0.75</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>k<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>X2</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z, <span class="at">breaks=</span><span class="dv">10000</span>,<span class="at">main =</span> <span class="st">&quot;p=0.75&quot;</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#p=0.5</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>k<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>X2</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z, <span class="at">breaks=</span><span class="dv">10000</span>,<span class="at">main =</span> <span class="st">&quot;p=0.5&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#p=0.25</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fl">0.25</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>k<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>X2</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z, <span class="at">breaks=</span><span class="dv">10000</span>,<span class="at">main =</span> <span class="st">&quot;p=0.25&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#p=0.375</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fl">0.375</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>k<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>X2</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z,<span class="at">breaks=</span><span class="dv">10000</span>, <span class="at">main =</span> <span class="st">&quot;p=0.375&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Consider the pdf of mixture <span class="math inline">\(p_1\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}x^2}+(1-p_1)e^{-\frac{1}{2}(x-3)^2}\)</span>. This is a bimodal function, which means the derivative of the above function has 3 zeros. The equation is <span class="math display">\[p_1xe^{-\frac{1}{2}x^2}+(1-p_1)(x-3)e^{-\frac{1}{2}(x-3)^2}=0.\]</span> i.e <span class="math display">\[p_1=\frac{(x-3)e^{-\frac{1}{2}(x-3)^2}}{(x-3)e^{-\frac{1}{2}(x-3)^2}-xe^{-\frac{1}{2}x^2}}.\]</span>Through numerical technique, we can get the approximate solution of <span class="math inline">\(p_1\)</span>.</p>
<p>Here we give a plot of the RHS function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.001</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span>x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">&lt;-</span>(x<span class="dv">-3</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">*</span>(x<span class="dv">-3</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>y2<span class="sc">/</span>(y2<span class="sc">-</span>y1)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v///8Ave4kAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHL0lEQVR4nO3di5aiRhSF4ZpLz0ybxDExobXe/0EjcmlQYZ+COnWOsv+1pld6uoHymxJBWCZENluwHoD3CAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBCAQiEIhAIAKBMgOFp8kKqFXKu1aFLIG6P64zBAoa681eYaDhUzs032ZZr16mM+gZnmP2+yDnQqZA12cYgSZXF/ovjiMQyHYfxKfY7Oo4g8DqEk92bCIQyPo4yP2RohLQIYS38/4yPf6aWd2GZ9Dx+38Xo7cYT7v36dVtF+i8v7BUX37HhmpqddsFOu0uz6zq6z+x+/p4ddsFks6g7R4o9vugK9XU6rZ8oCh7FXMxg8Db85s+1ZBcw9juyarwMo820HH2VSxazSD5hTDDN+3NZtCczp3Q9k5WEc/NiLYGJOAZD0kJ6PoSf2liD2QFNOMxJaR0oBja48MqODpZRc+mh4dEeqcaTX5OVpHO+JdGA5WtP2Es15PVJi8nqxKd4e+NBirbQsJo/M0gmU58MIW09kHtFAL7oO6LcmKeeD+FlF7FTrtmMxPzp+ypRgJPvBN6/eOgNJ7tASXybA0omeduWK/9dscCntspZPyGme4MWuTjCkj1KbaM53ZcDoCUhBb7bARoMc/NuCyBFJ9jy6dP3ATQGp4tAK3zGY/L8k17LaC1PpZA49WpAK3meXGgDD4vDZTD55WBcvCMX8ZeCijL9ImvC5TLZzSwdKDTrr4zam0KQPl81gHVb8mHqffi5UO4Gcf68vGsBooZjLID5fTJANQQTV55b/v4MXUH3ggo3yPK5b0aqAr13Yfn/cRVne6iT5hGzAuU2WclUP3wG5mp68rd9cJSMygzz+pXsesN0POddjUhAsq0E8ruk2UfhDpcGIsA5X56DdZ5/U/xMqkbOYb3EkAaPmWALvPnmz6Qis9w56h5qnHeT95onwtIhacYEF7dysemM30Ga476QHM3kq99ndfzKQj0eMPdI1r18BR97IBuVrfi8Wny+AFavhPS9dEHEt1IHhcDBWUfdSDZjeRxKZC6jzaQ8DbguGwnpM+jDiS8kTwuAirh88QzKBTxKbAPktxIPh6JbBRFeAq8ioluJB+MRLb2QtOn3lJ/f6nxcVAKUDkeRweKUfyAQ0kfR0DCKVSW5+mAQmkfT0BYqDxPvc3+i3iRzCMYjGXugd/qlPFxNYNmhO51yvB4BRo9/Ac4xXicAT22sOTxBiQTyrt9ODxXQAKhvFvHw6u36OBN+wd/74FneOzhYwbNCuXdsHR8oZtG4iUyD+B+RH50uuFET0APiPJuMa3+UNoRUPP35jTtOKK/GeQqtzPIS5xBIHcv894iEEgbSHpt3m3KQOJr824L3VcVIPmVVbfpziD5tXm36QJxBqHk1+a9pv0qJr427zXdnXT51WWPB4qgYkDzN5L7zeps3se7YYJ4Ng/iThoVBn/EC8h7+pPV9poGT1ZhZqcaT5MGkOBkFa50+kf2P1n964IZBFdqz6AIJDhZhSu1Z9AEwiercKX2DKpA61dqz0CgxT/J8eurV2rPQKDFP8nx66tXas/gAeiVIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEyglUhfD5ebCjb2b7+NVfIZEtdL182b8pLtzQcdngcgJVl21W3XZH38x22vWXkGQLnfeXXzl2HzAv3FB9O8qCweUEai4KHd7uv5mt+ryQLVyo+SjZ9gYc4TKn3Xv9u6mDizmBRuMefTNXFd77i5Diha4LNjMgZZkOKGk7GYF+1iNuH+3oG9AnUMJC8ZC+oWP7rEraTj6g5p+0/YcdfYMW7EaatFC7l5YvU/U79pTtPCtQNdxHSzfUfVi/EVDJp9jnpe+kp0u337J5ii3bScchkHSh4+dRUNIOt/0odaOd9MKX+QGQdKHj4AO/kw4NqqRDgyb7A8XBXJct9PFjeGuJcEOHy+6nv33H5kCxP5pvDjeO4qP5K1DCQsfmDpMvv5M2dAj1/1QleXA8WUURCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCOQdqL4P7HqTs1XegeqbnuY/rEg570Cx+vr3H8J7nVRyDxQPQXYzoVL+garBLZsGuQc67/+U3a+rlHug4/d/94YvYu6B6o8mFN4Tr5N3oOb+ZsPdtHcg8wgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQKD/AeariwSb5iReAAAAAElFTkSuQmCC" /><!-- --></p>
<p>From the plot, we can see that the approximate solution of <span class="math inline">\(p_1\)</span> is <span class="math inline">\(0.2&lt;p_1&lt;0.8\)</span>.</p>
<p>We can give another 2 plots to test our conjecture.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#p=0.2</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fl">0.2</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>k<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>X2</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z, <span class="at">breaks=</span><span class="dv">10000</span>,<span class="at">main =</span> <span class="st">&quot;p=0.2&quot;</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#p=0.375</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fl">0.8</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>k<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>X2</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z,<span class="at">breaks=</span><span class="dv">10000</span>, <span class="at">main =</span> <span class="st">&quot;p=0.8&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t),t\ge 0\}\)</span> that can be represented as the random sum <span class="math inline">\(X(t)=\sum_{i=1}^{N(t)}Y_i,\quad t\ge 0\)</span>, where <span class="math inline">\(\{N(t),t\ge 0\}\)</span> is a Poisson process and <span class="math inline">\(Y_1,Y_2,\cdots\)</span> are i.i.d and independent of <span class="math inline">\(\{N(t),t\ge 0\}\)</span>. Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)-Gamma process(Y has a Gamma distribution). Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values.</p>
<p>Hint: Show that <span class="math inline">\(E[X(t)]=\lambda tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t))=\lambda t E[Y_1^2]\)</span>.</p>
</div>
<div id="answer3" class="section level2">
<h2>Answer3</h2>
<p>1、Generate a Poisson random number <span class="math inline">\(N(t_0)\)</span>.</p>
<p>2、Based on the number <span class="math inline">\(N(t_0)\)</span>, we make a convolution of <span class="math inline">\(Y_j\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lambda=1,alpha=1,beta=1, we have E[Y]=1, E[Y^2]=2, the results should be E[X]=10,Var[X]=20</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t0)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  Yk<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,<span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  X[k]<span class="ot">&lt;-</span><span class="fu">sum</span>(Yk)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X)</span></code></pre></div>
<pre><code>## [1] 10.03161</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X)</span></code></pre></div>
<pre><code>## [1] 19.99365</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lambda=10,alpha=2,beta=0.5,we have E[Y]=4,E[Y^2]=24,the results should be E[X]=400,Var[X]=2400</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t0)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  Yk<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,<span class="dv">2</span>,<span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  X[k]<span class="ot">&lt;-</span><span class="fu">sum</span>(Yk)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X)</span></code></pre></div>
<pre><code>## [1] 400.0216</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X)</span></code></pre></div>
<pre><code>## [1] 2415.542</code></pre>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<div id="question1-1" class="section level2">
<h2>Question1</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf, and use the function to estimate F(x) for <span class="math inline">\(x=0.1,0.2,\cdots,0.9\)</span>. Compare the estimates with the values returned by the pbeta function in R.</p>
</div>
<div id="answer1-1" class="section level2">
<h2>Answer1</h2>
<p>The pdf of <span class="math inline">\(Beta(\alpha,\beta)\)</span> is <span class="math display">\[
  f(x;\alpha,\beta)=\frac{1}{B(\alpha,\beta)}x^{\alpha-1}(1-x)^{\beta-1}  
\]</span> Then, the cdf is <span class="math display">\[
  \theta=\int_{0}^{x}f(t;\alpha,\beta)dt,\quad x\in(0,1]
\]</span> Define <span class="math inline">\(g(t)=xf(t;\alpha,\beta)\)</span>, we have</p>
<p><span class="math display">\[
  \theta=E[g(Y)]=xE[f(Y;\alpha,\beta)],\quad Y\sim U(0,x)
\]</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>MC_beta<span class="ot">&lt;-</span><span class="cf">function</span>(x)<span class="co">#生成一个函数来模拟beta(3,3)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,x)<span class="co">#生成n个(0,x)上均匀分布的随机数</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">=</span>x<span class="sc">*</span><span class="fu">mean</span>(y<span class="sc">*</span>y<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">/</span><span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  theta</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>i<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">MC_beta</span>(x),<span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)))</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.008560544 0.008560000
## [1] 0.05794706 0.05792000
## [1] 0.1631115 0.1630800
## [1] 0.3175391 0.3174400
## [1] 0.499951 0.500000
## [1] 0.6830952 0.6825600
## [1] 0.8376112 0.8369200
## [1] 0.9418994 0.9420800
## [1] 0.9916557 0.9914400</code></pre>
</div>
<div id="question2-2" class="section level2">
<h2>Question2</h2>
<p>The Rayleigh density [156, (18.76)] is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}},\quad x\ge0,\sigma\ge0\]</span></p>
<p>Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>)distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span>?</p>
</div>
<div id="answer2-2" class="section level2">
<h2>Answer2</h2>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}},\quad x\ge0,\sigma\ge0\]</span></p>
<p>The cdf is <span class="math display">\[
  \theta=\int_0^x\frac{t}{\sigma^2}e^{-\frac{t^2}{2\sigma^2}}dt
\]</span> The simple estimator is <span class="math display">\[
  \hat{\theta}=\frac{1}{m}\sum_{j=1}^mx\frac{U_jx}{\sigma^2}e^{-\frac{(U_jx)^2}{2\sigma^2}},\quad U_j\sim U(0,1)
\]</span></p>
<p>The antithetic variable estimator is <span class="math display">\[
  \hat{\theta}=\frac{1}{m}\sum_{j=1}^{\frac{m}{2}}x\left(\frac{U_jx}{\sigma^2}e^{-\frac{(U_jx)^2}{2\sigma^2}}+\frac{x(1-U_j)}{\sigma^2}e^{-\frac{(x(1-U_j))^2}{2\sigma^2}}\right),\quad U_j\sim U(0,1)
\]</span> Assume <span class="math inline">\(\sigma=1\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MC模拟cdf</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>MC_Rayleigh<span class="ot">&lt;-</span><span class="cf">function</span>(x, <span class="at">m=</span><span class="fl">1e5</span>, <span class="at">antithetic=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>antithetic)v<span class="ot">&lt;-</span><span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)<span class="cf">else</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    v<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">c</span>(u,v)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  cdf<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    g<span class="ot">&lt;-</span>x[i]<span class="sc">*</span>u<span class="sc">*</span>x[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(u<span class="sc">*</span>x[i])<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    cdf[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(g)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>MC1<span class="ot">&lt;-</span><span class="fu">MC_Rayleigh</span>(x)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>MC2<span class="ot">&lt;-</span><span class="fu">MC_Rayleigh</span>(x,<span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,MC1)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,MC2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#下面计算方差的减少</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e2</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>MC1<span class="ot">&lt;-</span>MC2<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="dv">3</span><span class="sc">/</span>j</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    MC1[i]<span class="ot">=</span><span class="fu">MC_Rayleigh</span>(x)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    MC2[i]<span class="ot">=</span><span class="fu">MC_Rayleigh</span>(x,<span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(x,(<span class="fu">var</span>(MC2)<span class="sc">-</span><span class="fu">var</span>(MC1))<span class="sc">/</span><span class="fu">var</span>(MC2)))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 3.00000000 0.02404781
## [1] 1.5000000 0.3141869
## [1] 1.0000000 0.8815042
## [1] 0.7500000 0.9727941
## [1] 0.6000000 0.9896734</code></pre>
<p>From the above results, when x is close to 0, the percent reduction is close to 1.</p>
</div>
<div id="question3-1" class="section level2">
<h2>Question3</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on (1,<span class="math inline">\(\infty\)</span>) and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},\quad x&gt;1\]</span>.</p>
<p>Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\]</span></p>
<p>by importance sampling? Explain.</p>
</div>
<div id="answer3-1" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">*</span>x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>drayleigh <span class="ot">=</span> <span class="cf">function</span> (x, sigma) {</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> x <span class="sc">/</span> (sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  y[x <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  y</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>ys.g <span class="ot">=</span> <span class="fu">g</span>(xs)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#f1用rayleigh分布</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>ys.rayleigh <span class="ot">=</span> <span class="fu">drayleigh</span>(xs, <span class="at">sigma =</span> <span class="dv">1</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#f2用正态分布</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>ys.norm <span class="ot">=</span> <span class="fu">dnorm</span>(xs, <span class="at">mean =</span> <span class="dv">1</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>lim <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">c</span>(ys.g, ys.rayleigh, ys.norm))</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, ys.g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xs, ys.rayleigh, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xs, ys.norm, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the above plot, the red curve is f1 and the blue is f2. We can see that f2 is closer to g.</p>
</div>
<div id="question4" class="section level2">
<h2>Question4</h2>
<p>Obtain a Monte Carlo estimate of<span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\]</span></p>
<p>by importance sampling.</p>
</div>
<div id="answer4" class="section level2">
<h2>Answer4</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fl">1e5</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mean) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>rf2 <span class="ot">=</span> <span class="cf">function</span> () {</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mean)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>is.norm <span class="ot">=</span> <span class="cf">function</span> () {</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  xs <span class="ot">=</span> <span class="fu">rf2</span>()</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">g</span>(xs)<span class="sc">/</span><span class="fu">f2</span>(xs), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">2</span>)  </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>theta2 <span class="ot">=</span> <span class="fu">is.norm</span>()</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>theta2</span></code></pre></div>
<pre><code>## [1] 0.4004445</code></pre>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="question1-2" class="section level2">
<h2>Question1</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer1-2" class="section level2">
<h2>Answer1</h2>
<p>In this question, we have 2 steps to solve this question.</p>
<p>(a)Use a Monte Carlo experiment to estimate the coverage probability.</p>
<p>(b)Compare my t-interval results with the simulation results in Example 6.4.</p>
<p>Firstly, we solve (a).</p>
<p>(a)Distribution: <span class="math inline">\(\chi^2(2)\)</span>, sample size: <span class="math inline">\(20\)</span>, purpose: estimate the coverage probability.</p>
<p>The flowchart is as following:</p>
<p>Suppose that <span class="math inline">\(X\sim \chi^2(2)\)</span>, <span class="math inline">\(\theta\)</span> is the mean to be estimated.</p>
<p>1、j: m cycles.</p>
<p>2、In each cycle, we generate n random samples and compute the confidence interval <span class="math inline">\(C_j\)</span> of <span class="math inline">\(\theta\)</span>.</p>
<p>3、Compute the coverage probability <span class="math inline">\(\frac{1}{m}\sum_{j=1}^mI(\theta\in C_j)\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="dv">2</span>)  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  lci<span class="ot">=</span><span class="fu">t.test</span>(x)[<span class="dv">4</span>]<span class="sc">$</span>conf.int[<span class="dv">1</span>]</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  rci<span class="ot">=</span><span class="fu">t.test</span>(x)[<span class="dv">4</span>]<span class="sc">$</span>conf.int[<span class="dv">2</span>]</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (lci<span class="sc">&lt;</span><span class="dv">2</span> <span class="sc">&amp;</span> <span class="dv">2</span><span class="sc">&lt;</span>rci)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    y[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(y)<span class="sc">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.9139</code></pre>
<p>The result is smaller than that in Example 6.4.</p>
</div>
<div id="question2-3" class="section level2">
<h2>Question2</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i)<span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0\)</span> : <span class="math inline">\(\mu=\mu_0\)</span> vs <span class="math inline">\(H_0\)</span> : <span class="math inline">\(\mu\neq\mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer2-3" class="section level2">
<h2>Answer2</h2>
<p>Firstly, we need to make out the flowchart. Remark: empirical Type I error means the null hypothesis is rejected when in fact the null hypothesis is true.</p>
<p>1、j: m cycles.</p>
<p>2、In each cycle, we generate n random samples from the null distribution and compute the test statistic <span class="math inline">\(T_j\)</span>. In this problem, <span class="math inline">\(T_j\)</span> is the mean.</p>
<p>3、Record the test decision <span class="math inline">\(I_j=1\)</span> if <span class="math inline">\(H_0\)</span> is rejected at significance level <span class="math inline">\(\alpha\)</span>.</p>
<p>4、Compute <span class="math inline">\(\frac{1}{m}\sum_{j=1}^m I_j\)</span> and compare it with <span class="math inline">\(\alpha\)</span>.</p>
<p>Then, we can answer this question.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>I<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>L<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 自由度为1的卡方分布</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">t.test</span>(x)[<span class="dv">3</span>]<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    I[j]<span class="ot">=</span><span class="dv">1</span><span class="co">#reject mu=mu0</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(I)<span class="sc">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.1088</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (0,2)上的均匀分布</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>I<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">t.test</span>(x)[<span class="dv">3</span>]<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    I[j]<span class="ot">=</span><span class="dv">1</span><span class="co">#reject mu=mu0</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(I)<span class="sc">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.0522</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 均值为1的指数分布</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>I<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rexp</span>(n,<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">t.test</span>(x)[<span class="dv">3</span>]<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    I[j]<span class="ot">=</span><span class="dv">1</span><span class="co">#reject mu=mu0</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(I)<span class="sc">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.0746</code></pre>
<p>The empirical Type I error rates of <span class="math inline">\(\chi^2(1)\)</span> and <span class="math inline">\(Exp(1)\)</span> are larger than <span class="math inline">\(1-\alpha\)</span>.</p>
</div>
<div id="question3-2" class="section level2">
<h2>Question3</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<p>(a)What is the corresponding hypothesis test problem?</p>
<p>(b)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p>
<p>(c)Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answer3-2" class="section level2">
<h2>Answer3</h2>
<p>(a)Suppose the powers for two method are <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_2\)</span> respectively. Then the hypothesis test is <span class="math inline">\(H_0:|P_1-P_2|=0.05\)</span>.</p>
<p>(b)(c) I choose McNemar.</p>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="question1-3" class="section level2">
<h2>Question1:</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\]</span>.</p>
<p>Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[
  b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n ((X_i-\overline{X})^T\hat{\Sigma}^{-1}(X_j-\overline{X}))^3
\]</span></p>
<p>where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer1-3" class="section level2">
<h2>Answer1:</h2>
<p>In this problem, we need to repeat Example 6.8 and 6.10 with Mardia’s multivariate skewness test.</p>
<p>Assume <span class="math inline">\(d=2\)</span>.</p>
<p>(a)Ex6.8:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#计算b_1d</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">=</span><span class="fu">proc.time</span>()</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="cf">function</span>(n)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MASS)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  mean<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  sigma<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">mvrnorm</span>(n,mean,sigma)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  barX<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(X[,<span class="dv">1</span>]),<span class="fu">mean</span>(X[,<span class="dv">2</span>]))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#计算方差阵的极大似然</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  DX<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>n,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  DX[,<span class="dv">1</span>]<span class="ot">=</span>X[,<span class="dv">1</span>]<span class="sc">-</span>barX[<span class="dv">1</span>]</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  DX[,<span class="dv">2</span>]<span class="ot">=</span>X[,<span class="dv">2</span>]<span class="sc">-</span>barX[<span class="dv">2</span>]</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  Sigma<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  Sigma<span class="ot">=</span><span class="fu">t</span>(DX)<span class="sc">%*%</span>DX<span class="sc">/</span>n</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#计算偏度</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  b1d<span class="ot">=</span><span class="fu">mean</span>((DX<span class="sc">%*%</span><span class="fu">solve</span>(Sigma)<span class="sc">%*%</span><span class="fu">t</span>(DX))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  b1d</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成渐进分布</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">400</span>,<span class="dv">900</span>,<span class="dv">1600</span>,<span class="dv">2500</span>,<span class="dv">3600</span>,<span class="dv">4900</span>,<span class="dv">6400</span>,<span class="dv">8100</span>,<span class="dv">10000</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>cv<span class="ot">&lt;-</span><span class="dv">6</span><span class="sc">*</span><span class="fu">qchisq</span>(<span class="fl">0.975</span>,<span class="dv">2</span>)<span class="sc">/</span>n</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co">#比较</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="co"># p.reject=numeric(length(n)) </span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="co"># m=100</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(n))</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="co"># {</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   sktests &lt;- numeric(m)</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   for (j in 1:m)</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   {</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     sktests[j] &lt;- as.integer(abs(b(n[i])) &gt;= cv[i] )</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.reject[i] &lt;- mean(sktests) #proportion rejected</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="co"># t2=proc.time()</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="co"># p.reject</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="co"># t2-t1</span></span></code></pre></div>
<p>(b)Ex6.10: In this part, we need to repeat the process on multivariate normal distribution. The contaminated normal distribution is denoted by <span class="math display">\[
  (1-\epsilon)N(0,\Sigma_1)+\epsilon N(0,\Sigma_2),\quad 0\le\epsilon\le1.
\]</span> For this experiment, the significance level is <span class="math inline">\(\alpha=0.1\)</span> and the sample size is <span class="math inline">\(n=900\)</span>. The skewness statistic is implemented in (a). We just need to change the generation process.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.1</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>epsilon<span class="ot">=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">01</span>), <span class="fu">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, .<span class="dv">05</span>))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fu">length</span>(epsilon)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>pwr<span class="ot">=</span><span class="fu">numeric</span>(N)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>cv<span class="ot">=</span><span class="dv">6</span><span class="sc">*</span><span class="fu">qchisq</span>(<span class="fl">0.95</span>,<span class="dv">2</span>)<span class="sc">/</span>n</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="cf">function</span>(n,e)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MASS)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>n,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  mean<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    X[i,]<span class="ot">=</span><span class="fu">mvrnorm</span>(<span class="at">n=</span><span class="dv">1</span>,<span class="at">mu=</span>mean,<span class="at">Sigma=</span><span class="fu">matrix</span>(<span class="fu">c</span>(sigma[i],<span class="dv">0</span>,<span class="dv">0</span>,sigma[i]),<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">nrow=</span><span class="dv">2</span> ))</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  barX<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(X[,<span class="dv">1</span>]),<span class="fu">mean</span>(X[,<span class="dv">2</span>]))</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#计算方差阵的极大似然</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  DX<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>n,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  DX[,<span class="dv">1</span>]<span class="ot">=</span>X[,<span class="dv">1</span>]<span class="sc">-</span>barX[<span class="dv">1</span>]</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  DX[,<span class="dv">2</span>]<span class="ot">=</span>X[,<span class="dv">2</span>]<span class="sc">-</span>barX[<span class="dv">2</span>]</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  Sigma<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  Sigma<span class="ot">=</span><span class="fu">t</span>(DX)<span class="sc">%*%</span>DX<span class="sc">/</span>n</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#计算偏度</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  b1d<span class="ot">=</span><span class="fu">mean</span>((DX<span class="sc">%*%</span><span class="fu">solve</span>(Sigma)<span class="sc">%*%</span><span class="fu">t</span>(DX))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  b1d</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="co"># for (j in 1:N)</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="co"># {</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   e &lt;- epsilon[j]</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   sktests &lt;- numeric(m)</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   for (i in 1:m)</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   {</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     sktests[i] &lt;- as.integer(abs(b1(n,e)) &gt;= cv)</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   pwr[j] &lt;- mean(sktests)</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="co"># #plot power vs epsilon</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(epsilon, pwr, type = &quot;b&quot;,</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a><span class="co"># xlab = bquote(epsilon), ylim = c(0,1))</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(h = .1, lty = 3)</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a><span class="co"># se &lt;- sqrt(pwr * (1-pwr) / m) #add standard errors</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a><span class="co"># lines(epsilon, pwr+se, lty = 3)</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a><span class="co"># lines(epsilon, pwr-se, lty = 3)</span></span></code></pre></div>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="ex7.7" class="section level2">
<h2>EX7.7</h2>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following example [84, Ch. 7]. The five-dimensional scores data have a 5 × 5 covariance matrix <span class="math inline">\(\Sigma\)</span>,with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\cdots&gt;\lambda_5\)</span>. In principal components analysis, <span class="math display">\[
  \theta=\frac{\lambda_1}{\sum_{j=1}^5\lambda_j}
\]</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat\lambda_1&gt;\cdots&gt;\hat\lambda_5\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[
  \hat\theta=\frac{\hat\lambda_1}{\sum_{j=1}^5\hat\lambda_j}
\]</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>hat_lambda<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>hat_theta<span class="ot">=</span>hat_lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(hat_lambda)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>hat_theta</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#估计bias</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e3</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(scor)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  index<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size =</span> n,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>scor[index,]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(dat))<span class="sc">$</span>values</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  theta[i]<span class="ot">=</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(theta<span class="sc">-</span>hat_theta)</span></code></pre></div>
<pre><code>## [1] 0.001505899</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#估计se</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e3</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(scor)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  index<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size =</span> n,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>scor[index,]</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(dat))<span class="sc">$</span>values</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  theta[i]<span class="ot">=</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(theta)</span></code></pre></div>
<pre><code>## [1] 0.0460462</code></pre>
</div>
<div id="ex7.8" class="section level2">
<h2>EX7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#估计bias</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(scor)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(dat))<span class="sc">$</span>values</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  theta[i]<span class="ot">=</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta)<span class="sc">-</span>hat_theta)</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#估计se</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(scor)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(dat))<span class="sc">$</span>values</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  theta[i]<span class="ot">=</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta<span class="sc">-</span><span class="fu">mean</span>(theta))<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="ex7.9" class="section level2">
<h2>EX7.9</h2>
<p>Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#计算percentile CI</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor, <span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>theta_boot<span class="ot">=</span><span class="cf">function</span>(da,index)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  dat<span class="ot">=</span>da[index,]</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(dat))<span class="sc">$</span>values</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(<span class="fu">boot</span>(scor,<span class="at">statistic =</span> theta_boot,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type=</span><span class="st">&quot;perc&quot;</span>)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot(scor, statistic = theta_boot, R = 1000), 
##     type = &quot;perc&quot;)
## 
## Intervals : 
## Level     Percentile     
## 95%   ( 0.5258,  0.7092 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#计算BCa CI</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(<span class="fu">boot</span>(scor,<span class="at">statistic =</span> theta_boot,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type=</span><span class="st">&quot;bca&quot;</span>)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot(scor, statistic = theta_boot, R = 1000), 
##     type = &quot;bca&quot;)
## 
## Intervals : 
## Level       BCa          
## 95%   ( 0.5160,  0.7012 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="ex7.b" class="section level2">
<h2>EX7.B</h2>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness).</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>In this project, we need to solve the following problems:</p>
<p>(a)Use Monte Carlo to estimate the coverage probabilities of the standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval.</p>
<p>(b)Find the proportion of times that the confidence intervals miss on the left, and the porportion of times that the confidence intervals miss on the right.</p>
<p>(c)Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2\)</span>(5) distributions (positive skewness).</p>
<p>Firstly, the sample skewness statistic is <span class="math display">\[
  \sqrt{b_1}=\frac{\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^3}{(\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^2)^{\frac{3}{2}}}
\]</span></p>
<p>The sample skewness function is</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">=</span><span class="cf">function</span>(x,index)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  xbar<span class="ot">=</span><span class="fu">mean</span>(x[index])</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  m3<span class="ot">=</span><span class="fu">mean</span>((x[index] <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">=</span><span class="fu">mean</span>((x[index] <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  m3<span class="sc">/</span>m2<span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then, we use Monte Carlo to solve (a), (b) and (c).</p>
<p>(a)&amp;(b)</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#norm，输出结果依次为cp，left_pr，right_pr</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e1</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>right<span class="ot">=</span>left<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rnorm</span>(n)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  theta1<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  theta2<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>normal[<span class="dv">3</span>]</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="dv">0</span><span class="sc">&lt;</span>theta1)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    left[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(theta2<span class="sc">&lt;</span><span class="dv">0</span>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>      right[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>      y[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(y))</span></code></pre></div>
<pre><code>## [1] 0.86</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(left))</span></code></pre></div>
<pre><code>## [1] 0.03</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(right))</span></code></pre></div>
<pre><code>## [1] 0.11</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#basic，输出结果依次为cp，left_pr，right_pr</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e1</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>right<span class="ot">=</span>left<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rnorm</span>(n)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  theta1<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>basic[<span class="dv">4</span>]</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  theta2<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>basic[<span class="dv">5</span>]</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="dv">0</span><span class="sc">&lt;</span>theta1)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    left[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(theta2<span class="sc">&lt;</span><span class="dv">0</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>      right[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>      y[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(y))</span></code></pre></div>
<pre><code>## [1] 0.94</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(left))</span></code></pre></div>
<pre><code>## [1] 0.04</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(right))</span></code></pre></div>
<pre><code>## [1] 0.02</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#perc，输出结果依次为cp，left_pr，right_pr</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e1</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>right<span class="ot">=</span>left<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rnorm</span>(n)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  theta1<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>percent[<span class="dv">4</span>]</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  theta2<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>percent[<span class="dv">5</span>]</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="dv">0</span><span class="sc">&lt;</span>theta1)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    left[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(theta2<span class="sc">&lt;</span><span class="dv">0</span>)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>      right[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>      y[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(y))</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(left))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(right))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Next, we repeat the process on <span class="math inline">\(\chi^2(5)\)</span>. The skewness of <span class="math inline">\(\chi^2(5)\)</span> is <span class="math display">\[
  \sqrt{\beta_1}=\frac{E[(X-\mu_X)]^3}{\sigma_X^3}=\frac{2\sqrt{10}}{5}
\]</span></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#norm，输出结果依次为cp，left_pr，right_pr</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e1</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>right<span class="ot">=</span>left<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>skew<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">10</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  theta1<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  theta2<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>normal[<span class="dv">3</span>]</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(skew<span class="sc">&lt;</span>theta1)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    left[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(theta2<span class="sc">&lt;</span>skew)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>      right[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>      y[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(y))</span></code></pre></div>
<pre><code>## [1] 0.76</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(left))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(right))</span></code></pre></div>
<pre><code>## [1] 0.24</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#basic，输出结果依次为cp，left_pr，right_pr</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e1</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>right<span class="ot">=</span>left<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  theta1<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>basic[<span class="dv">4</span>]</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  theta2<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>basic[<span class="dv">5</span>]</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(skew<span class="sc">&lt;</span>theta1)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    left[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(theta2<span class="sc">&lt;</span>skew)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>      right[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>      y[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(y))</span></code></pre></div>
<pre><code>## [1] 0.77</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(left))</span></code></pre></div>
<pre><code>## [1] 0.03</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(right))</span></code></pre></div>
<pre><code>## [1] 0.2</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#perc，输出结果依次为cp，left_pr，right_pr</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e1</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>right<span class="ot">=</span>left<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  theta1<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>percent[<span class="dv">4</span>]</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  theta2<span class="ot">=</span><span class="fu">boot.ci</span>(<span class="fu">boot</span>(x,<span class="at">statistic =</span>sk,<span class="at">R=</span><span class="fl">1e3</span>),<span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)[<span class="dv">4</span>]<span class="sc">$</span>percent[<span class="dv">5</span>]</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(skew<span class="sc">&lt;</span>theta1)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    left[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(theta2<span class="sc">&lt;</span>skew)</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>      right[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>      y[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(y))</span></code></pre></div>
<pre><code>## [1] 0.79</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(left))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(right))</span></code></pre></div>
<pre><code>## [1] 0.21</code></pre>
<p>From the results above, we can see that the coverage rates of normal populations are larger than that of <span class="math inline">\(\chi^2(5)\)</span> distributions.</p>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="problem1" class="section level2">
<h2>Problem1</h2>
<p>Implement the bivariate Spearman rank correlation test for independence [255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer1-4" class="section level2">
<h2>Answer1</h2>
<p>The Spearman rank correlation test statistic is <span class="math display">\[
  \rho=1-\frac{6\sum_{i=1}^nd_i^2}{n(n^2-1)}
\]</span> Here, <span class="math inline">\(d_i\)</span> is the difference of rank between <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_i\)</span>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#生成两个随机样本</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(m,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">rnorm</span>(m,<span class="at">mean=</span><span class="dv">100</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co">#写出Spearman rank 相关系数统计量</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>spearman<span class="ot">=</span><span class="cf">function</span>(x,y)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="fu">rank</span>(x)<span class="sc">-</span><span class="fu">rank</span>(y)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  rho<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>(<span class="dv">6</span><span class="sc">*</span><span class="fu">sum</span>(d<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(n<span class="sc">^</span><span class="dv">3</span><span class="sc">-</span>n)</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  rho</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co">#利用Spearman rank做置换检验</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>boot.obj<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span><span class="fu">rbind</span>(x,y),<span class="at">statistic=</span>spearman,<span class="at">R=</span><span class="dv">1000</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>tb<span class="ot">=</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tb<span class="sc">&gt;=</span>boot.obj<span class="sc">$</span>t0)</span></code></pre></div>
<pre><code>## [1] 0.5074925</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#利用cor.test</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 204038, p-value = 0.02503
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.2243504</code></pre>
<p>The achieved significance level is larger than 0.05 so the null hypothesis of independence is accepted, i.e the random array x and y are independent.</p>
<p>From the above two tests, the achieved significance level of permutation test is smaller than that of cor.test.</p>
</div>
<div id="problem2" class="section level2">
<h2>Problem2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>(i)Unequal variances and equal expectations</p>
<p>(ii)Unequal variances and unequal expectations</p>
<p>(iii)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>(iv)Unbalanced samples (say, 1 case versus 10 controls)</p>
<p>(v)Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
</div>
<div id="answer2-4" class="section level2">
<h2>Answer2</h2>
<p>(i)We choose <span class="math inline">\(F\sim N(0,1)\)</span> and <span class="math inline">\(G\sim U(-10,10)\)</span>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">=</span><span class="dv">8</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">runif</span>(n2,<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># NN method</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>Tn<span class="ot">=</span><span class="cf">function</span>(z,index,sizes,k)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">=</span>sizes[<span class="dv">1</span>]</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">=</span>sizes[<span class="dv">2</span>]</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>n1<span class="sc">+</span>n2</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>((z)))</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    z<span class="ot">=</span><span class="fu">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">=</span>z[index,]</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>  NN<span class="ot">=</span><span class="fu">nn2</span>(<span class="at">data=</span>z,<span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>  block1<span class="ot">=</span>NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>  block2<span class="ot">=</span>NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>  i1<span class="ot">=</span><span class="fu">sum</span>(block1<span class="sc">&lt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>  i2<span class="ot">=</span><span class="fu">sum</span>(block2<span class="sc">&gt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>  (i1<span class="sc">+</span>i2)<span class="sc">/</span>(k<span class="sc">*</span>n)</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>eqdist.nn<span class="ot">=</span><span class="cf">function</span>(z,sizes,k)</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span><span class="dv">2000</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="at">sizes=</span>N,<span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>  ts<span class="ot">=</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a><span class="fu">eqdist.nn</span>(z,N,k)</span></code></pre></div>
<pre><code>## [1] 0.2943528</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Energy method</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>boot.obs<span class="ot">=</span><span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span><span class="fu">c</span>(n1,n2),<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>boot.obs<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.2348826</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ball method </span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bd.test</span>(x,y,<span class="at">num.permutations =</span> <span class="dv">2000</span>)<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##          0.1364318</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Power Comparison</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="fl">2e3</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for(i in 1:m)</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co"># {</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   x=rnorm(n1,0,1)</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   y=runif(n2,-10,10)</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   z=c(x,y)</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,1]=eqdist.nn(z,N,k)</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,2]=eqdist.etest(z,N,R=R)$p.value</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,3]=bd.test(x,y,num.permutations = R)$p.value</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha=0.1</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a><span class="co"># pow=colMeans(p.values&lt;alpha)</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="co"># names(pow)=c(&quot;NN&quot;,&quot;Energy&quot;,&quot;Ball&quot;)</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a><span class="co"># pow</span></span></code></pre></div>
<p>(ii)We choose <span class="math inline">\(F\sim N(0,1)\)</span> and <span class="math inline">\(G\sim U(10,20)\)</span>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">=</span><span class="dv">8</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">runif</span>(n2,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># NN method</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>Tn<span class="ot">=</span><span class="cf">function</span>(z,index,sizes,k)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">=</span>sizes[<span class="dv">1</span>]</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">=</span>sizes[<span class="dv">2</span>]</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>n1<span class="sc">+</span>n2</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>((z)))</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    z<span class="ot">=</span><span class="fu">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">=</span>z[index,]</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>  NN<span class="ot">=</span><span class="fu">nn2</span>(<span class="at">data=</span>z,<span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  block1<span class="ot">=</span>NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>  block2<span class="ot">=</span>NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>  i1<span class="ot">=</span><span class="fu">sum</span>(block1<span class="sc">&lt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>  i2<span class="ot">=</span><span class="fu">sum</span>(block2<span class="sc">&gt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>  (i1<span class="sc">+</span>i2)<span class="sc">/</span>(k<span class="sc">*</span>n)</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>eqdist.nn<span class="ot">=</span><span class="cf">function</span>(z,sizes,k)</span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span><span class="dv">2000</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="at">sizes=</span>N,<span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a>  ts<span class="ot">=</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a><span class="fu">eqdist.nn</span>(z,N,k)</span></code></pre></div>
<pre><code>## [1] 0.0004997501</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Energy method</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>boot.obs<span class="ot">=</span><span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span><span class="fu">c</span>(n1,n2),<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>boot.obs<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.0004997501</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ball method </span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bd.test</span>(x,y,<span class="at">num.permutations =</span> <span class="dv">2000</span>)<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##       0.0004997501</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Power Comparison</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="fl">2e3</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for(i in 1:m)</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co"># {</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   x=rnorm(n1,0,1)</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   y=runif(n2,10,20)</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   z=c(x,y)</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,1]=eqdist.nn(z,N,k)</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,2]=eqdist.etest(z,N,R=R)$p.value</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,3]=bd.test(x,y,num.permutations = R)$p.value</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha=0.1</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="co"># pow=colMeans(p.values&lt;alpha)</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a><span class="co"># names(pow)=c(&quot;NN&quot;,&quot;Energy&quot;,&quot;Ball&quot;)</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="co"># pow</span></span></code></pre></div>
<p>(iii)We choose <span class="math inline">\(F\sim t(1)\)</span> and <span class="math inline">\(G\sim N(0,1)+N(10,1)\)</span>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">=</span><span class="dv">8</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rt</span>(n1,<span class="dv">1</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2,<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n2,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>k<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>X2</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co"># NN method</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>Tn<span class="ot">=</span><span class="cf">function</span>(z,index,sizes,k)</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">=</span>sizes[<span class="dv">1</span>]</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">=</span>sizes[<span class="dv">2</span>]</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>n1<span class="sc">+</span>n2</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>((z)))</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>    z<span class="ot">=</span><span class="fu">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">=</span>z[index,]</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  NN<span class="ot">=</span><span class="fu">nn2</span>(<span class="at">data=</span>z,<span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>  block1<span class="ot">=</span>NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>  block2<span class="ot">=</span>NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>  i1<span class="ot">=</span><span class="fu">sum</span>(block1<span class="sc">&lt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>  i2<span class="ot">=</span><span class="fu">sum</span>(block2<span class="sc">&gt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>  (i1<span class="sc">+</span>i2)<span class="sc">/</span>(k<span class="sc">*</span>n)</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>eqdist.nn<span class="ot">=</span><span class="cf">function</span>(z,sizes,k)</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span><span class="dv">2000</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="at">sizes=</span>N,<span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>  ts<span class="ot">=</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a><span class="fu">eqdist.nn</span>(z,N,k)</span></code></pre></div>
<pre><code>## [1] 0.06946527</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Energy method</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>boot.obs<span class="ot">=</span><span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span><span class="fu">c</span>(n1,n2),<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>boot.obs<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.03048476</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ball method </span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bd.test</span>(x,y,<span class="at">num.permutations =</span> <span class="dv">2000</span>)<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##         0.05547226</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Power Comparison</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="fl">2e3</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for(i in 1:m)</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="co"># {</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   x=rt(n1,1)</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   X1&lt;-rnorm(n2,0,1)</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   X2&lt;-rnorm(n2,10,1)</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   k&lt;-sample(c(0,1),n2,replace = TRUE,prob = c(0.5,0.5))</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   y&lt;-k*X1+(1-k)*X2</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   z=c(x,y)</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,1]=eqdist.nn(z,N,k)</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,2]=eqdist.etest(z,N,R=R)$p.value</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,3]=bd.test(x,y,num.permutations = R)$p.value</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha=0.1</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a><span class="co"># pow=colMeans(p.values&lt;alpha)</span></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a><span class="co"># names(pow)=c(&quot;NN&quot;,&quot;Energy&quot;,&quot;Ball&quot;)</span></span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a><span class="co"># pow</span></span></code></pre></div>
<p>(iv)We choose <span class="math inline">\(F\sim t(1)\)</span> and <span class="math inline">\(G\sim N(0,1)+N(10,1)\)</span>, <span class="math inline">\(n_1=20\)</span> and <span class="math inline">\(n2=4\)</span>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rt</span>(n1,<span class="dv">1</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n2,<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n2,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>k<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>X2</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co"># NN method</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>Tn<span class="ot">=</span><span class="cf">function</span>(z,index,sizes,k)</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">=</span>sizes[<span class="dv">1</span>]</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">=</span>sizes[<span class="dv">2</span>]</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>n1<span class="sc">+</span>n2</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>((z)))</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>    z<span class="ot">=</span><span class="fu">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">=</span>z[index,]</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>  NN<span class="ot">=</span><span class="fu">nn2</span>(<span class="at">data=</span>z,<span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>  block1<span class="ot">=</span>NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>  block2<span class="ot">=</span>NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>  i1<span class="ot">=</span><span class="fu">sum</span>(block1<span class="sc">&lt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>  i2<span class="ot">=</span><span class="fu">sum</span>(block2<span class="sc">&gt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>  (i1<span class="sc">+</span>i2)<span class="sc">/</span>(k<span class="sc">*</span>n)</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>eqdist.nn<span class="ot">=</span><span class="cf">function</span>(z,sizes,k)</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span><span class="dv">2000</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="at">sizes=</span>N,<span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>  ts<span class="ot">=</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a><span class="fu">eqdist.nn</span>(z,N,k)</span></code></pre></div>
<pre><code>## [1] 0.1024488</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Energy method</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>boot.obs<span class="ot">=</span><span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span><span class="fu">c</span>(n1,n2),<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>boot.obs<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.003998001</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ball method </span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bd.test</span>(x,y,<span class="at">num.permutations =</span> <span class="dv">2000</span>)<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##         0.01349325</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Power Comparison</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="fl">2e3</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for(i in 1:m)</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co"># {</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   x=rt(n1,1)</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   X1&lt;-rnorm(n2,0,1)</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   X2&lt;-rnorm(n2,10,1)</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   k&lt;-sample(c(0,1),n2,replace = TRUE,prob = c(0.5,0.5))</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   y&lt;-k*X1+(1-k)*X2</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   z=c(x,y)</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,1]=eqdist.nn(z,N,k)</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,2]=eqdist.etest(z,N,R=R)$p.value</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   p.values[i,3]=bd.test(x,y,num.permutations = R)$p.value</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha=0.1</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="co"># pow=colMeans(p.values&lt;alpha)</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a><span class="co"># names(pow)=c(&quot;NN&quot;,&quot;Energy&quot;,&quot;Ball&quot;)</span></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a><span class="co"># pow</span></span></code></pre></div>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="ex9.3" class="section level2">
<h2>Ex9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with <span class="math inline">\(df=1\)</span>). Recall that a Cauchy(<span class="math inline">\(\theta,\eta\)</span>) distribution has density function</p>
<p><span class="math display">\[
  f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},\quad -\infty&lt;x&lt;\infty,\theta&gt;0
\]</span></p>
<p>The standard Cauchy has the Cauchy(<span class="math inline">\(\theta=1,\eta=0\)</span>) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>We choose <span class="math inline">\(\theta=1,\eta=0\)</span>.</p>
<p>(a)Generate random variables from a standard Cauchy distribution.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fl">2e4</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>M_H<span class="ot">=</span><span class="cf">function</span>(N)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">numeric</span>(N)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) </span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>    xt<span class="ot">=</span>x[i<span class="dv">-1</span>]</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,xt)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>    u<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>    r<span class="ot">=</span><span class="fu">dcauchy</span>(y)<span class="sc">*</span><span class="fu">dnorm</span>(xt,y)<span class="sc">/</span>(<span class="fu">dcauchy</span>(xt)<span class="sc">*</span><span class="fu">dnorm</span>(y,xt))</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u<span class="sc">&lt;=</span>r)</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>      x[i]<span class="ot">=</span>y</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>      k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>      x[i]<span class="ot">=</span>xt</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>(b)Discard the first 1000 of the chain and show the plot.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>index<span class="ot">=</span><span class="dv">1001</span><span class="sc">:</span>N</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(index,<span class="fu">M_H</span>(N)[index])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(c)Compare the deciles of the generated observations with the deciles of the standard Cauchy distribution.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>index2<span class="ot">=</span><span class="fl">5e3</span><span class="sc">:</span>N</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qcauchy</span>(p)</span></code></pre></div>
<pre><code>## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197  0.7265425
## [8]  1.3763819  3.0776835</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">M_H</span>(N)[index2],<span class="at">probs =</span> p)</span></code></pre></div>
<pre><code>##         10%         20%         30%         40%         50%         60% 
## -2.96395037 -1.36894038 -0.74572532 -0.34761010 -0.03688045  0.26130852 
##         70%         80%         90% 
##  0.64894865  1.27928169  2.68698916</code></pre>
</div>
<div id="ex9.8" class="section level2">
<h2>Ex9.8</h2>
<p>This example appears in [40]. Consider the bivariate density</p>
<p><span class="math display">\[
  f(x,y)\propto \tbinom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\quad x=0,1,\cdots,n,\quad 0\le y\le1
\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>We list some parameters:</p>
<p><span class="math display">\[
  \begin{align}
    &amp; f(x|y)\sim Binomial(n,y)\\
    &amp; f(y|x)\sim Beta(x+a,n-x+b)
  \end{align}
\]</span> For a bivariate distribution <span class="math inline">\((X,Y)\)</span>, at each iteration the Gibbs sampler</p>
<p>1、Sets <span class="math inline">\((x_1,x_2)=X(t-1)\)</span>;</p>
<p>2、Generates <span class="math inline">\(X_1^{\ast}(t)\)</span> from <span class="math inline">\(f(X_1|x_2)\)</span>;</p>
<p>3、Updates <span class="math inline">\(x_1=X_1^{\ast}(t)\)</span>;</p>
<p>4、Generates <span class="math inline">\(X_2^{\ast}(t)\)</span> from <span class="math inline">\(f(X_2|x_1)\)</span>;</p>
<p>5、Sets <span class="math inline">\(X(t)=(X_1^{\ast}(t),X_2^{\ast}(t))\)</span>.</p>
<p>Suppose <span class="math inline">\(a=2,b=3,n=4\)</span>.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fl">1e4</span>           <span class="co">#length of chain</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">=</span><span class="fl">2e3</span>        <span class="co">#burn</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>G<span class="ot">=</span><span class="cf">function</span>(N)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>) <span class="co">#chain</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>)    <span class="co">#initial</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N)</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>    x2<span class="ot">=</span>X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>]<span class="ot">=</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,x2)</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">=</span>X[i,<span class="dv">1</span>]</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">=</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>  X</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">G</span>(N)[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(x)</span></code></pre></div>
<pre><code>## [1] 39.1885000  0.3918487</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x)</span></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,] 451.831697 4.31833519
## [2,]   4.318335 0.04310533</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.9785038
## [2,] 0.9785038 1.0000000</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x[,<span class="dv">1</span>],<span class="at">breaks =</span> <span class="dv">20</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x[,<span class="dv">2</span>],<span class="at">breaks =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="ex" class="section level2">
<h2>Ex</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it convergens approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>(a)Ex9.3:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>G.R<span class="ot">=</span><span class="cf">function</span>(psi)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  psi<span class="ot">=</span><span class="fu">as.matrix</span>(psi)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">ncol</span>(psi)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="fu">nrow</span>(psi)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  psi.means<span class="ot">=</span><span class="fu">rowMeans</span>(psi)</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  B<span class="ot">=</span>n<span class="sc">*</span><span class="fu">var</span>(psi.means)</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  psi.w<span class="ot">=</span><span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>  W<span class="ot">=</span><span class="fu">mean</span>(psi.w)</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>  v.hat<span class="ot">=</span>W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>(B<span class="sc">/</span>n)</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>  r.hat<span class="ot">=</span>v.hat<span class="sc">/</span>W</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>  r.hat</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">3e4</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>X<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> k,<span class="at">ncol =</span> n)</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) </span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>  X[i,]<span class="ot">=</span><span class="fu">M_H</span>(n)</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>psi<span class="ot">=</span><span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>  psi[i,]<span class="ot">=</span>psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">G.R</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.081771</code></pre>
<p>(b)Ex9.8:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">19</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fl">6e5</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>X<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> k,<span class="at">ncol =</span> N)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> k,<span class="at">ncol =</span> N)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  X[i,]<span class="ot">=</span><span class="fu">G</span>(N)[,<span class="dv">1</span>]</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>  Y[i,]<span class="ot">=</span><span class="fu">G</span>(N)[,<span class="dv">2</span>]</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>psi.x<span class="ot">=</span><span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>psi.y<span class="ot">=</span><span class="fu">t</span>(<span class="fu">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi.x))</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  psi.x[i,]<span class="ot">=</span>psi.x[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi.x))</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">G.R</span>(psi.x))</span></code></pre></div>
<pre><code>## [1] 1.023794</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi.y))</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  psi.y[i,]<span class="ot">=</span>psi.y[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi.y))</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">G.R</span>(psi.y))</span></code></pre></div>
<pre><code>## [1] 1.064553</code></pre>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="ex11.3" class="section level2">
<h2>Ex11.3</h2>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>k_term<span class="ot">=</span><span class="cf">function</span>(a,k)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="fu">length</span>(a)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">norm</span>(a,<span class="st">&quot;2&quot;</span>)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="fl">+1.5</span>)<span class="sc">/</span>(<span class="fu">factorial</span>(k)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>k<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>xk<span class="ot">=</span><span class="cf">function</span>(a,x)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="fu">length</span>(a)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="fu">floor</span>(x)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  p1<span class="ot">=</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">norm</span>(a,<span class="st">&quot;2&quot;</span>))<span class="sc">+</span><span class="fu">log</span>(<span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">log</span>(<span class="fu">gamma</span>(k<span class="fl">+1.5</span>))</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  p2<span class="ot">=</span><span class="fu">log</span>(<span class="fu">factorial</span>(k))<span class="sc">+</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">log</span>(<span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x<span class="sc">&gt;=</span>k)<span class="sc">*</span>(x<span class="sc">&lt;</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(p1<span class="sc">-</span>p2))</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>s<span class="ot">=</span><span class="cf">function</span>(a)</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">integrate</span>(xk,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span><span class="dv">140</span>,<span class="at">a=</span>a)</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## 1.532174 with absolute error &lt; 0.00014</code></pre>
</div>
<div id="ex11.5" class="section level2">
<h2>Ex11.5</h2>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>(a)Solve 11.4.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>intersection <span class="ot">=</span> <span class="cf">function</span> (k) </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  sn <span class="ot">=</span> <span class="cf">function</span> (a,n) </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> n <span class="sc">/</span> (n<span class="sc">+</span><span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>)), <span class="at">df =</span> n)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  equa <span class="ot">=</span> <span class="cf">function</span> (a) {</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sn</span>(a,k) <span class="sc">-</span> <span class="fu">sn</span>(a,k<span class="dv">-1</span>)</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">=</span> <span class="fl">1e-6</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uniroot</span>(equa, <span class="at">interval =</span> <span class="fu">c</span>(e, <span class="fu">sqrt</span>(k)<span class="sc">-</span>e))<span class="sc">$</span>root</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> k) {</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">intersection</span>(i))</span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1.492103
## [1] 4.999999
## [1] 9.999999
## [1] 22.36068
## [1] 31.62278</code></pre>
<p>(b)Solve 11.5.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>solve.equa <span class="ot">=</span> <span class="cf">function</span> (k) </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">=</span> <span class="cf">function</span>(u, n)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>  cn <span class="ot">=</span> <span class="cf">function</span> (n, a) </span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> n <span class="sc">/</span> (n <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>  xn <span class="ot">=</span> <span class="cf">function</span> (n, a) </span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>    ff <span class="ot">=</span> <span class="cf">function</span> (u) </span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">f</span>(u, n)</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">=</span> <span class="fu">cn</span>(n <span class="sc">-</span> <span class="dv">1</span>, a)</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(n<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>(n<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">integrate</span>(ff, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> c)<span class="sc">$</span>value</span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>  equa <span class="ot">=</span> <span class="cf">function</span> (a) </span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xn</span>(k,a)<span class="sc">-</span><span class="fu">xn</span>(k<span class="sc">+</span><span class="dv">1</span>,a)</span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">=</span> <span class="fl">1e-6</span></span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">sqrt</span>(k),e)</span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a>  w<span class="ot">=</span><span class="fu">length</span>(s)</span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a>  r<span class="ot">=</span>s[w]</span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">equa</span>(e)<span class="sc">*</span><span class="fu">equa</span>(r)<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a>    w<span class="ot">=</span>w<span class="dv">-1</span></span>
<span id="cb143-39"><a href="#cb143-39" aria-hidden="true" tabindex="-1"></a>    r<span class="ot">=</span>s[w]</span>
<span id="cb143-40"><a href="#cb143-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb143-41"><a href="#cb143-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uniroot</span>(equa,<span class="at">lower=</span>e,<span class="at">upper=</span>r)<span class="sc">$</span>root</span>
<span id="cb143-42"><a href="#cb143-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-43"><a href="#cb143-43" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb143-44"><a href="#cb143-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> k) {</span>
<span id="cb143-45"><a href="#cb143-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">solve.equa</span>(i))</span>
<span id="cb143-46"><a href="#cb143-46" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1.492103
## [1] 4.999998
## [1] 9.684153
## [1] 22.30349
## [1] 1.730897</code></pre>
<p>(c)Compare.</p>
<p>The results of 11.4 and 11.5 on 4,25,100,500 are the same respectively. When k=1000, there may be some difference for the result of 11.4 is very close to <span class="math inline">\(\sqrt{1000}\)</span>, the difference is litter than e.</p>
<p>I was confused by these two questions. When i change the value of e, the results are different.</p>
</div>
<div id="extra" class="section level2">
<h2>Extra</h2>
<p>Suppose <span class="math inline">\(T_1,\cdots,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i\le\tau)+\tau I(T_i&gt;\tau), \quad i=1,\cdots,n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows:</p>
<p>0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85</p>
<p>Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE(note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>(a)EM algorithm: 假定完全数据<span class="math inline">\(T_1,\cdots,T_n\sim exp(1)\)</span>，观测数据为右删失的，只观测到<span class="math inline">\(Y_1,\cdots,Y_n\)</span>，其中<span class="math inline">\(Y_i=T_iI(T_i\le1)+ I(T_i&gt;1), \quad i=1,\cdots,n\)</span>。</p>
<p>完全数据的似然函数为<span class="math inline">\(L(\lambda|T)=n\log\lambda-\lambda\sum_{i=1}^n T_i\)</span>。可以计算 <span class="math display">\[
  \begin{align}
  Q(\lambda|\lambda^{(t)})
  &amp;=E[L(\lambda|T)|Y,\lambda^{(t)}]\\
  &amp;=n\log\lambda-\lambda\sum_{i=1}^n E[T_i|Y_i,\lambda^{(t)}]\\
  &amp;=n\log\lambda-\lambda\sum_{i=1}^n Y_i-\sum_{i=1}^nI(T_i\le1)\frac{\lambda}{\lambda^{(t)}}
  \end{align}
\]</span> 对<span class="math inline">\(\lambda\)</span>导数为<span class="math inline">\(\frac{n}{\lambda}-\sum_{i=1}^{n}Y_i-\sum_{i=1}^{n}I(T_i\le1)/\lambda^{(t)}\)</span>。</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(y)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>lambda.t<span class="ot">=</span><span class="dv">1</span> </span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>e<span class="ot">=</span><span class="fl">1e-3</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>lambda.tplus<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#EM</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>  lambda.tplus<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(<span class="fu">mean</span>(y)<span class="sc">+</span><span class="fu">mean</span>(<span class="fu">pexp</span>(y,<span class="dv">1</span>)<span class="sc">/</span>lambda.t))</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#更新&amp;判断</span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(lambda.tplus<span class="sc">-</span>lambda.t)<span class="sc">&lt;</span>e) <span class="cf">break</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>  lambda.t<span class="ot">=</span>lambda.tplus</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lambda.tplus)</span></code></pre></div>
<pre><code>## [1] 0.7882561</code></pre>
<p>(b)MLE:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(y)<span class="sc">/</span><span class="fu">sum</span>(y)</span></code></pre></div>
<pre><code>## [1] 1.481481</code></pre>
<p>可以看到，直接MLE得到的<span class="math inline">\(\lambda\)</span>值更大，这表明指数分布均值更小，这是符合我们认知的，右删失数据的真实均值应该更大一些，对指数分布而言，参数<span class="math inline">\(\lambda\)</span>更小。</p>
</div>
</div>
<div id="homework-10" class="section level1">
<h1>Homework 10</h1>
<div id="ex1-of-page204" class="section level2">
<h2>Ex1 of Page204:</h2>
<p>Why are the following two invocations of lapply() equivalent?</p>
<p>trims &lt;- c(0, 0.1, 0.2, 0.5)</p>
<p>x &lt;- rcauchy(100)</p>
<p>lapply(trims, function(trim) mean(x, trim = trim))</p>
<p>lapply(trims, mean, x = x)</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer:</h2>
<p>这里我们先看一下结果，再给出说明。</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim)))</span></code></pre></div>
<pre><code>## [1] 0.3039514 0.2602335 0.1489934 0.1385068</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x))</span></code></pre></div>
<pre><code>## [1] 0.3039514 0.2602335 0.1489934 0.1385068</code></pre>
<p>可以看到结果是一样的。</p>
<p>解释：</p>
<p>第一个是在trims上遍历，每次生成100个Cauchy随机数，去掉占比trim的异常值，返回剩余平均数；</p>
<p>第二个是在trims上遍历，函数为求均值，对x求均值，均值函数需要调用trims中的值，而mean函数的三个参数中，只有trim可以调用trims，所以去掉占比trim的异常值后对x求均值。</p>
</div>
<div id="ex5-of-page204" class="section level2">
<h2>Ex5 of Page204:</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer:</h2>
<p>(a)Ex3:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(formulas, <span class="cf">function</span>(formulae) <span class="fu">rsq</span>(<span class="fu">lm</span>(formulae,mtcars))))</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<p>(b)Ex4:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) </span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(formulas, <span class="cf">function</span>(formulae) <span class="fu">rsq</span>(<span class="fu">lm</span>(formulae,mtcars[rows,])))</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>})),<span class="at">nrow=</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>##            [,1]      [,2]      [,3]      [,4]
##  [1,] 0.6134958 0.8596908 0.6034217 0.6551660
##  [2,] 0.7869124 0.9201126 0.8626468 0.8052569
##  [3,] 0.7204945 0.6653497 0.7901572 0.6652139
##  [4,] 0.8078353 0.8611096 0.8666938 0.9081480
##  [5,] 0.7405500 0.7336909 0.6926661 0.6993724
##  [6,] 0.9367648 0.8769749 0.8751586 0.9119548
##  [7,] 0.7592430 0.6863955 0.7305139 0.8385585
##  [8,] 0.9375064 0.7771693 0.8809113 0.8035902
##  [9,] 0.7744160 0.7245289 0.5818328 0.8763393
## [10,] 0.8702762 0.7843008 0.7959832 0.8816497</code></pre>
</div>
<div id="ex1-of-page214" class="section level2">
<h2>Ex1 of Page214:</h2>
<p>Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</p></li>
</ol>
</div>
<div id="answer-12" class="section level2">
<h2>Answer:</h2>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mtcars, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>sd1<span class="ot">=</span><span class="cf">function</span>(dat)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vapply</span>(dat[<span class="fu">vapply</span>(dat, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))<span class="co">#先用一个vapply判断是不是数值列，再用一个vapply进行方差计算</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sd1</span>(mtcars)</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
</div>
<div id="ex7-of-page214" class="section level2">
<h2>Ex7 of Page214:</h2>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer:</h2>
<p>mcsapply is similiar with mclapply for sapply is similiar with lapply. That means we can write a function mcsapply by using mclapply.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>mcsapply<span class="ot">=</span><span class="cf">function</span>(X,FUN)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  result<span class="ot">=</span>parallel<span class="sc">::</span><span class="fu">mclapply</span>(X,FUN)</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>(result)</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mcsapply</span>(mtcars,sd)</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>parallel<span class="sc">::</span><span class="fu">mclapply</span>(mtcars, sd)</span></code></pre></div>
<pre><code>## $mpg
## [1] 6.026948
## 
## $cyl
## [1] 1.785922
## 
## $disp
## [1] 123.9387
## 
## $hp
## [1] 68.56287
## 
## $drat
## [1] 0.5346787
## 
## $wt
## [1] 0.9784574
## 
## $qsec
## [1] 1.786943
## 
## $vs
## [1] 0.5040161
## 
## $am
## [1] 0.4989909
## 
## $gear
## [1] 0.7378041
## 
## $carb
## [1] 1.6152</code></pre>
<p>The implement of mcvapply may be more difficult for the operations of FUN.VALUE are complicated.</p>
</div>
</div>
<div id="homework-11" class="section level1">
<h1>Homework 11</h1>
<div id="ex1" class="section level2">
<h2>EX1</h2>
<p>Write an Rcpp function for Exercise 9.8.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(installr)</span></code></pre></div>
<pre><code>## 
## Welcome to installr version 0.23.2
## 
## More information is available on the installr project website:
## https://github.com/talgalili/installr/
## 
## Contact: &lt;tal.galili@gmail.com&gt;
## Suggestions and bug-reports can be submitted at: https://github.com/talgalili/installr/issues
## 
##          To suppress this message use:
##          suppressPackageStartupMessages(library(installr))</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fl">1e3</span>;thin<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;#include &lt;Rcpp.h&gt;</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="st">NumericMatrix gibbsC(int N, int thin) {</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix mat(N, 2);</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="st">  double x=0, y=0;</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="st">  int n=20;</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a><span class="st">  double a=2,b=1;</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a><span class="st">  for(int i = 0; i &lt; N; i++) {</span></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="st">    for(int j = 0; j &lt; thin; j++) {</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a><span class="st">      x = rbinom(1, n, y)[0];</span></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a><span class="st">      y = rbeta(1, x+a, n-x+b)[0];</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i, 0)=x;</span></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i, 1)=y;</span></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a><span class="st">  return(mat);</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: No function found for Rcpp::export attribute at file8cc818e81022.cpp:5</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>dataC<span class="ot">=</span><span class="fu">gibbsC</span>(N,thin)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(dataC))</span></code></pre></div>
<pre><code>##      [,1]      [,2]
## [1,]   17 0.9303326
## [2,]   19 0.9166779
## [3,]   16 0.8219433
## [4,]    9 0.4782369
## [5,]   17 0.8665723
## [6,]   17 0.7528880</code></pre>
</div>
<div id="ex2" class="section level2">
<h2>EX2</h2>
<p>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>gibbsR<span class="ot">=</span><span class="cf">function</span>(N, thin) {</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>y<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="dv">2</span>;b<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>     x<span class="ot">=</span><span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>     y<span class="ot">=</span><span class="fu">rbeta</span>(<span class="dv">1</span>, x<span class="sc">+</span>a, n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>    mat[i, ]<span class="ot">=</span><span class="fu">c</span>(x, y)</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>  mat</span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>dataR<span class="ot">=</span><span class="fu">gibbsR</span>(N,thin)</span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(dataR))</span></code></pre></div>
<pre><code>##      [,1]      [,2]
## [1,]   18 0.7832703
## [2,]    5 0.3133702
## [3,]   16 0.7486696
## [4,]   13 0.6418915
## [5,]   14 0.7860843
## [6,]   12 0.4987143</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>data<span class="ot">=</span>dataR<span class="sc">-</span>dataC</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>data[,<span class="dv">1</span>]</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>q<span class="ot">=</span><span class="fu">qnorm</span>(<span class="fu">rank</span>(x)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(q,x)</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>data[,<span class="dv">2</span>]</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>q<span class="ot">=</span><span class="fu">qnorm</span>(<span class="fu">rank</span>(y)<span class="sc">/</span><span class="fu">length</span>(y))</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(q,y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="ex3" class="section level2">
<h2>EX3</h2>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">gibbsR</span>(N,thin),<span class="at">gibbsC=</span><span class="fu">gibbsC</span>(N,thin))</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr       lq    median        uq
## 1 gibbsR 351.8300 360.05010 376.36280
## 2 gibbsC  33.7207  34.11245  34.95295</code></pre>
<p>这里由于是要比较计算时间，所以不能调用dataC和dataR，因为那是已经计算好的，必须要重新算一次。</p>
</div>
<div id="comment" class="section level2">
<h2>Comment</h2>
<p>在生成分布结果近似相同的情况下，C的运算效率大约比R高1个数量级。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
